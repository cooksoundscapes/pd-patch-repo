#N canvas 594 150 680 411 12;
#X declare -path atoms;
#X obj 20 78 t l b b;
#X obj 55 130 timer;
#X obj 20 234 list prepend;
#X msg 55 206 0;
#X obj 20 259 text set \$0seq 1e+09;
#X obj 352 297 text define \$0seq;
#X f 11;
#X obj 20 41 spigot;
#X obj 262 93 text sequence \$0seq;
#X msg 209 126 step;
#X msg 352 271 sort;
#X obj 262 18 r \$0play;
#X msg 262 68 line 0 \, step;
#X obj 262 118 list split 1;
#X obj 262 169 list, f 6;
#X obj 262 194 route list symbol;
#X obj 320 220 sel end;
#X obj 320 245 t b b;
#X obj 20 14 inlet;
#X obj 231 271 outlet;
#N canvas 88 263 450 300 waits 0;
#X obj 119 69 t f f;
#X obj 119 101 -, f 5;
#X obj 119 185 delay;
#X obj 119 126 t b f;
#X obj 119 210 outlet;
#X obj 119 43 inlet;
#X text 51 14 Absolute values to relatives;
#X msg 11 165 stop;
#X obj 151 156 * 1;
#X obj 169 127 r \$0speed;
#X obj 11 139 sel 0;
#X obj 11 113 r \$0play;
#X connect 0 0 1 1;
#X connect 0 1 1 0;
#X connect 1 0 3 0;
#X connect 2 0 4 0;
#X connect 3 0 2 0;
#X connect 3 1 8 0;
#X connect 5 0 0 0;
#X connect 7 0 2 0;
#X connect 8 0 2 1;
#X connect 9 0 8 1;
#X connect 10 0 7 0;
#X connect 11 0 10 0;
#X restore 262 144 pd waits;
#X obj 126 21 r \$0arm;
#X obj 126 110 sel 1;
#X obj 465 61 bng 24 250 50 0 empty empty armRecord -12 -5 0 10 #fcfcfc #000000 #000000;
#X obj 465 98 bng 24 250 50 0 empty empty play/stop -12 -7 0 10 #fcfcfc #000000 #000000;
#X floatatom 513 59 5 0 0 1 BPM \$0BpmBox \$0setBpm 0;
#X floatatom 513 82 2 1 32 1 - - \$0beats 0;
#X floatatom 531 82 3 2 32 0 - - - 0;
#X floatatom 513 36 5 0 0 1 bars - \$0setBars 0;
#X obj 582 89 cnv 16 60 16 empty \$0BarsLabel Bars:0 2 8 0 10 #605858 #fcfcb8 0;
#X obj 582 36 cnv 15 60 16 empty \$0statusLabel clear 2 8 0 12 #605b58 #ffffbb 0;
#X obj 514 107 bng 15 250 50 0 empty empty clear 17 7 0 10 #fcfcfc #000000 #000000;
#X text 180 14 1: rec \; 2: overdub;
#N canvas 837 119 506 402 statusLabel 0;
#X obj 76 349 s \$0statusLabel;
#X msg 33 119 label armed \, color #ff0000 0 #ffffff, f 18;
#X obj 254 148 metro 400;
#X obj 254 173 tgl 15 0 empty empty empty 17 7 0 10 #fcfcfc #000000 #000000 0 1;
#X obj 254 127 tgl 15 0 empty empty empty 17 7 0 10 #fcfcfc #000000 #000000 0 1;
#X obj 254 218 sel 0 1 2 3 5;
#X msg 153 249 color #ff0000 0 #ffffff, f 13;
#X msg 49 160 label REC;
#X msg 60 184 label overdub;
#X msg 76 212 label running;
#X msg 10 78 label clear \, color #605b58 0 #ffffbb, f 18;
#X obj 254 193 +;
#X floatatom 326 174 5 0 0 0 - - - 0;
#X msg 274 288 color #555555 0 #ffaa00, f 13;
#X msg 374 249 color #555555 0 #21dd54, f 13;
#X msg 384 289 color #21dd54 0 #ffffff, f 13;
#X msg 151 78 label stopped \, color #605b58 0 #21dd54, f 20;
#X msg 264 249 color #ffaa00 0 #555555, f 13;
#X msg 163 288 color #aaaaaa 0 #ff0000, f 13;
#X obj 254 22 t f f;
#X obj 326 148 * 2;
#X obj 65 21 r \$0state;
#X obj 254 50 >= 4;
#X obj 326 123 - 4;
#X obj 65 47 sel 0 1 2 3;
#X text 358 4 0: clear \; 1: armed \; 2: stopped \; 3: armed-dub \; 4: recording \; 5: layering \; 6: playing;
#X connect 1 0 0 0;
#X connect 2 0 3 0;
#X connect 3 0 11 0;
#X connect 4 0 2 0;
#X connect 5 0 6 0;
#X connect 5 0 7 0;
#X connect 5 1 18 0;
#X connect 5 2 17 0;
#X connect 5 2 8 0;
#X connect 5 3 13 0;
#X connect 5 4 15 0;
#X connect 5 4 9 0;
#X connect 5 5 14 0;
#X connect 6 0 0 0;
#X connect 7 0 0 0;
#X connect 8 0 0 0;
#X connect 9 0 0 0;
#X connect 10 0 0 0;
#X connect 11 0 5 0;
#X connect 12 0 11 1;
#X connect 13 0 0 0;
#X connect 14 0 0 0;
#X connect 15 0 0 0;
#X connect 16 0 0 0;
#X connect 17 0 0 0;
#X connect 18 0 0 0;
#X connect 19 0 22 0;
#X connect 19 1 23 0;
#X connect 20 0 12 0;
#X connect 21 0 24 0;
#X connect 21 0 19 0;
#X connect 22 0 4 0;
#X connect 23 0 20 0;
#X connect 24 0 10 0;
#X connect 24 1 1 0;
#X connect 24 2 16 0;
#X connect 24 3 8 0;
#X connect 24 3 17 0;
#X restore 548 159 pd statusLabel;
#N canvas 0 95 375 223 resetUI 0;
#X obj 78 53 loadbang;
#X obj 190 80 s \$0statusLabel;
#X obj 190 150 s \$0lengthLabel;
#X obj 134 166 outlet;
#X msg 190 40 label clear \, color #605b58 0 #ffffbb, f 20;
#X msg 134 142 4;
#X obj 78 104 t b b;
#X msg 190 110 label - \, color #605b58 0 #ffffbb, f 17;
#X connect 0 0 7 0;
#X connect 0 0 4 0;
#X connect 0 0 6 0;
#X connect 4 0 1 0;
#X connect 5 0 3 0;
#X connect 6 1 5 0;
#X connect 7 0 2 0;
#X restore 531 5 pd resetUI;
#N canvas 0 95 450 300 ArmingConditions 0;
#X obj 136 41 f;
#X msg 55 152 1;
#X obj 162 207 s \$0state;
#X msg 94 152 0;
#X msg 153 152 3;
#X obj 174 41 r \$0state;
#X msg 195 152 2;
#X obj 136 14 inlet;
#X msg 263 152 6;
#X obj 136 68 sel 0 1 2 3 5 6;
#X msg 302 152 5;
#X text 321 15 0: clear \; 1: armed \; 2: stopped \; 3: armed-dub \; 4: recording \; 5: layering \; 6: playing;
#X connect 0 0 9 0;
#X connect 1 0 2 0;
#X connect 3 0 2 0;
#X connect 4 0 2 0;
#X connect 5 0 0 1;
#X connect 6 0 2 0;
#X connect 7 0 0 0;
#X connect 8 0 2 0;
#X connect 9 0 1 0;
#X connect 9 1 3 0;
#X connect 9 2 4 0;
#X connect 9 3 6 0;
#X connect 9 4 8 0;
#X connect 9 5 10 0;
#X connect 10 0 2 0;
#X restore 401 135 pd ArmingConditions;
#N canvas 0 95 450 427 PlayingConditions 0;
#X obj 112 183 f;
#X obj 140 324 s \$0state;
#X obj 150 183 r \$0state;
#X obj 113 41 inlet;
#X msg 94 280 6;
#X msg 129 280 5;
#X msg 164 280 3;
#X obj 112 208 sel 2 3 4 5 6;
#X msg 199 280 2;
#X obj 179 350 s \$0endSignal;
#X obj 147 242 t b b;
#X text 15 184 last state =>;
#X obj 226 222 r \$0autoStop;
#X obj 196 375 outlet;
#X text 331 136 0: clear \; 1: armed \; 2: stopped \; 3: armed-dub \; 4: recording \; 5: layering \; 6: playing;
#X obj 113 66 tgl 15 0 empty empty empty 17 7 0 10 #fcfcfc #000000 #000000 0 1;
#X floatatom 170 134 5 0 0 0 - - - 0;
#X connect 0 0 7 0;
#X connect 2 0 0 1;
#X connect 2 0 16 0;
#X connect 3 0 15 0;
#X connect 3 0 0 0;
#X connect 4 0 1 0;
#X connect 5 0 1 0;
#X connect 6 0 1 0;
#X connect 7 0 4 0;
#X connect 7 1 5 0;
#X connect 7 2 10 0;
#X connect 7 3 6 0;
#X connect 7 4 8 0;
#X connect 8 0 1 0;
#X connect 10 0 5 0;
#X connect 10 1 9 0;
#X connect 10 1 13 0;
#X connect 12 0 10 0;
#X restore 401 159 pd PlayingConditions;
#X msg 576 184 0;
#X obj 576 209 s \$0state;
#N canvas 104 195 450 273 processState 0;
#X obj 95 17 r \$0state;
#X obj 95 42 sel 0 1 2 3 4 5 6, f 29;
#X obj 22 62 t b b;
#X msg 193 132 1, f 2;
#X obj 152 160 s \$0arm;
#X msg 22 87 -1;
#X obj 22 112 text delete \$0seq, f 11;
#X text 321 15 0: clear \; 1: armed \; 2: stopped \; 3: armed-dub \; 4: recording \; 5: layering \; 6: playing;
#X obj 237 221 s \$0play;
#X obj 237 98 t b b;
#X msg 269 140 2, f 2;
#X msg 152 132 0, f 2;
#X msg 92 171 0;
#X msg 237 130 1, f 2;
#X obj 237 191 change;
#X connect 0 0 1 0;
#X connect 1 0 2 0;
#X connect 1 1 3 0;
#X connect 1 2 11 0;
#X connect 1 2 12 0;
#X connect 1 3 12 0;
#X connect 1 5 9 0;
#X connect 1 6 11 0;
#X connect 1 6 13 0;
#X connect 2 0 5 0;
#X connect 2 1 12 0;
#X connect 2 1 11 0;
#X connect 3 0 4 0;
#X connect 5 0 6 0;
#X connect 9 0 13 0;
#X connect 9 1 10 0;
#X connect 10 0 4 0;
#X connect 11 0 4 0;
#X connect 12 0 14 0;
#X connect 13 0 14 0;
#X connect 14 0 8 0;
#X restore 401 183 pd processState;
#X msg 85 78 symbol end;
#X obj 85 53 r \$0endSignal;
#N canvas 0 95 450 251 getLength 0;
#X obj 59 21 inlet;
#X obj 59 46 list split 1;
#X obj 99 73 route symbol;
#X obj 99 98 sel end;
#X obj 59 182 s \$0length;
#X obj 248 125 s \$0lengthLabel;
#X obj 59 148 spigot;
#X msg 99 123 1, f 2;
#X msg 145 128 0, f 2;
#X obj 248 14 r \$0speed;
#X obj 248 39 t b f;
#X obj 248 73 * 1;
#X obj 248 99 pretty-time;
#X connect 0 0 1 0;
#X connect 1 0 6 0;
#X connect 1 1 2 0;
#X connect 2 0 3 0;
#X connect 2 1 8 0;
#X connect 3 0 7 0;
#X connect 3 1 8 0;
#X connect 6 0 4 0;
#X connect 6 0 11 0;
#X connect 7 0 6 1;
#X connect 8 0 6 1;
#X connect 9 0 10 0;
#X connect 10 0 11 0;
#X connect 10 1 11 1;
#X connect 11 0 12 0;
#X connect 12 0 5 0;
#X restore 49 284 pd getLength;
#X obj 262 43 sel 1;
#X obj 570 108 hsl 70 14 0 1 0 0 empty \$0progressBar 3.8 -2 7 0 12 #dcdcdc #fc8000 #c45800 0 1;
#N canvas 0 95 450 300 progressBar 0;
#X obj 204 37 r \$0play;
#X obj 186 121 f;
#X obj 226 121 + 1;
#X obj 226 146 %;
#X obj 226 171 /;
#X obj 226 196 s \$0progressBar;
#X obj 204 63 t f f;
#X obj 186 96 metro 10;
#X obj 269 126 / 10;
#X obj 269 60 r \$0length;
#X obj 132 204 / 100;
#X obj 132 229 makefilename %.1f;
#X msg 132 254 label \$1;
#X obj 110 111 r \$0state;
#X obj 110 136 sel 0;
#X msg 110 162 0;
#X obj 322 84 r \$0speed;
#X obj 269 99 * 1;
#X obj 322 109 t b f;
#X connect 0 0 6 0;
#X connect 1 0 2 0;
#X connect 2 0 3 0;
#X connect 3 0 4 0;
#X connect 3 0 1 1;
#X connect 3 0 10 0;
#X connect 4 0 5 0;
#X connect 6 0 1 1;
#X connect 6 1 7 0;
#X connect 7 0 1 0;
#X connect 8 0 3 1;
#X connect 8 0 4 1;
#X connect 9 0 17 0;
#X connect 10 0 11 0;
#X connect 11 0 12 0;
#X connect 12 0 5 0;
#X connect 13 0 14 0;
#X connect 14 0 15 0;
#X connect 15 0 5 0;
#X connect 15 0 10 0;
#X connect 16 0 18 0;
#X connect 17 0 8 0;
#X connect 18 0 17 0;
#X connect 18 1 17 1;
#X restore 401 207 pd progressBar;
#X obj 139 179 r \$0speed;
#N canvas 200 168 431 377 estimate 0;
#X obj 198 34 r \$0length;
#X msg 107 200 60000 \$1;
#X obj 107 226 /;
#X obj 127 91 moses 850;
#X obj 187 116 / 2;
#X obj 266 126 r \$0beats;
#X obj 205 201 /;
#X obj 198 60 t f f;
#X obj 266 154 moses 2;
#X obj 312 180 / 2;
#X obj 127 166 / 1;
#X obj 136 137 t b f;
#X obj 35 110 r \$0setBpm;
#X msg 35 135 60000 \$1;
#X obj 35 160 /;
#X obj 35 186 /;
#X obj 35 211 s \$0speed;
#X obj 205 176 swap;
#X obj 205 226 /;
#X msg 107 302 label BPM:\$1;
#X obj 107 327 s \$0BpmLabel;
#X msg 205 302 label Bars:\$1;
#X obj 205 327 s \$0BarsLabel;
#X obj 27 327 s \$0BpmBox;
#X msg 27 302 set \$1;
#X obj 107 258 makefilename %.1f, f 9;
#X connect 0 0 7 0;
#X connect 1 0 2 0;
#X connect 2 0 24 0;
#X connect 2 0 25 0;
#X connect 3 0 10 0;
#X connect 3 1 4 0;
#X connect 4 0 3 0;
#X connect 5 0 8 0;
#X connect 5 0 18 1;
#X connect 6 0 18 0;
#X connect 7 0 3 0;
#X connect 7 1 17 1;
#X connect 8 0 11 0;
#X connect 8 1 9 0;
#X connect 9 0 8 0;
#X connect 10 0 1 0;
#X connect 10 0 15 1;
#X connect 10 0 17 0;
#X connect 11 0 10 0;
#X connect 11 1 10 1;
#X connect 12 0 13 0;
#X connect 13 0 14 0;
#X connect 14 0 15 0;
#X connect 15 0 16 0;
#X connect 17 0 6 0;
#X connect 17 1 6 1;
#X connect 18 0 21 0;
#X connect 19 0 20 0;
#X connect 21 0 22 0;
#X connect 24 0 23 0;
#X connect 25 0 19 0;
#X restore 401 231 pd estimate;
#N canvas 0 95 450 300 onRec 0;
#X msg 117 132 4;
#X obj 117 157 s \$0state;
#X msg 188 132 1;
#X obj 188 157 s \$0speed;
#X obj 147 71 inlet;
#X obj 147 96 t b b;
#X connect 0 0 1 0;
#X connect 2 0 3 0;
#X connect 4 0 5 0;
#X connect 5 0 0 0;
#X connect 5 1 2 0;
#X restore 114 234 pd onRec;
#X obj 101 179 / 1;
#N canvas 0 95 450 300 showTime 0;
#X obj 113 29 r \$0beats;
#X obj 113 54 i;
#X obj 221 50 t f f;
#X obj 253 99 wrap;
#X obj 253 75 log 2;
#X obj 253 124 == 0;
#X obj 221 151 spigot;
#X obj 221 25 inlet;
#X obj 139 222 s \$0signatureLabel;
#X obj 139 171 pack;
#X msg 139 196 label \$1/\$2;
#X obj 150 140 b;
#X obj 231 181 s \$0divider;
#X connect 0 0 1 0;
#X connect 1 0 9 0;
#X connect 2 0 6 0;
#X connect 2 1 4 0;
#X connect 3 0 5 0;
#X connect 4 0 3 0;
#X connect 5 0 6 1;
#X connect 6 0 9 1;
#X connect 6 0 11 0;
#X connect 6 0 12 0;
#X connect 7 0 2 0;
#X connect 9 0 10 0;
#X connect 10 0 8 0;
#X connect 11 0 9 0;
#X restore 565 135 pd showTime;
#X obj 513 82 cnv 15 43 19 empty \$0signatureLabel 4/4 2 10 0 14 #606060 #fcfcc4 0;
#X obj 582 55 cnv 16 60 16 empty \$0lengthLabel - 2 8 0 10 #605b58 #ffffbb 0;
#X obj 582 72 cnv 16 60 16 empty \$0BpmLabel BPM:0.0 2 8 0 10 #605858 #fcfcb8 0;
#N canvas 153 140 450 300 noteOffs 0;
#X obj 50 65 inlet;
#X obj 50 152 outlet;
#X obj 170 124 bag;
#X msg 170 98 flush;
#X obj 170 73 sel 0;
#X obj 170 47 r \$0play;
#X msg 170 154 \$1 0;
#X obj 75 96 route float;
#X connect 0 0 1 0;
#X connect 0 0 7 0;
#X connect 2 0 6 0;
#X connect 3 0 2 0;
#X connect 4 0 3 0;
#X connect 5 0 4 0;
#X connect 6 0 1 0;
#X connect 7 0 2 0;
#X restore 231 245 pd noteOffs;
#X obj 456 354 symbol \$0seq;
#X obj 456 379 outlet;
#X obj 456 304 r \$0state;
#X obj 456 329 sel 5;
#X text 19 310 How it works: records a list of absolute waits \, by resetting the timer only at the beginning of the sequence \, so new notes are time-tagged with that zero reference. Then \, at the start of the next cycle \, the list is sorted \;, f 45;
#X obj 55 105 one-pass;
#X obj 55 155 one-pass;
#X obj 341 6 declare -path atoms;
#X connect 0 0 2 0;
#X connect 0 1 59 0;
#X connect 0 2 1 1;
#X connect 1 0 60 0;
#X connect 2 0 4 0;
#X connect 2 0 41 0;
#X connect 3 0 2 1;
#X connect 6 0 0 0;
#X connect 7 0 12 0;
#X connect 8 0 7 0;
#X connect 9 0 5 0;
#X connect 10 0 42 0;
#X connect 11 0 7 0;
#X connect 12 0 19 0;
#X connect 12 1 13 1;
#X connect 13 0 14 0;
#X connect 14 0 8 0;
#X connect 14 0 53 0;
#X connect 14 1 15 0;
#X connect 15 0 16 0;
#X connect 16 0 11 0;
#X connect 16 1 9 0;
#X connect 16 1 1 0;
#X connect 17 0 6 0;
#X connect 19 0 13 0;
#X connect 20 0 6 1;
#X connect 20 0 21 0;
#X connect 21 0 59 1;
#X connect 21 0 60 1;
#X connect 22 0 34 0;
#X connect 23 0 35 0;
#X connect 26 0 49 0;
#X connect 30 0 36 0;
#X connect 33 0 26 0;
#X connect 33 0 25 0;
#X connect 35 0 16 0;
#X connect 36 0 37 0;
#X connect 39 0 0 0;
#X connect 40 0 39 0;
#X connect 42 0 11 0;
#X connect 45 0 48 1;
#X connect 48 0 2 1;
#X connect 53 0 18 0;
#X connect 54 0 55 0;
#X connect 56 0 57 0;
#X connect 57 0 54 0;
#X connect 59 0 1 0;
#X connect 60 0 3 0;
#X connect 60 0 47 0;
#X connect 60 1 48 0;
#X coords 0 -1 1 1 198 98 1 450 30;
